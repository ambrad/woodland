#include "woodland/acorn/hs3d.hpp"

#include <cmath>

namespace woodland {
namespace acorn {
namespace hs3d {

template <typename RealT>
void calc_halfspace_term_B (
  const Real lam, const Real mu, const RealT v[3], const RealT d[3],
  const RealT& y3, const RealT& x1, const RealT& x3, RealT sigma[6])
{
  const Real
    lm = lam + mu,
    l2m = lam + 2*mu;
  const RealT
    d1 = d[0], d2 = d[1], d3 = d[2],
    v1 = v[0], v2 = v[1], v3 = v[2],
    z1 = x1, z3 = -(x3 + y3),
    z11 = z1*z1, z33 = z3*z3, z13 = z1*z3,
    z111 = z11*z1,
    R2 = z11 + z33,
    R = std::sqrt(R2),
    R3 = R2*R;
  const RealT
    R4 = R2*R2, R5 = R4*R, R7 = R5*R2,
    z333 = z33*z3,
    z1111 = z11*z11, z3333 = z33*z33,
    z3pR = z3 + R,
    z3pRpow2 = z3pR*z3pR,
    z3pRpow3 = z3pRpow2*z3pR,
    z3pRpow4 = z3pRpow2*z3pRpow2;
    const auto T_x_0  = lam*((1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(6*l2m*z1111*(1 - lm/l2m)/(lm*R4*z3pRpow3) + 6*l2m*z1111*(1 - lm/l2m)/(lm*R3*z3pRpow4) + 3*l2m*z1111*(1 - lm/l2m)/(lm*R5*z3pRpow2) - 12*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - 6*l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + 3*l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 15*z1111/R7 + 12*z11/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 15*z11*z33/R7 + 3*z11/R5 + 3*z33/R5 - 1/R3)/(M_PI*mu)) + (1.0/2.0)*(6*l2m*z1111*(1 - lm/l2m)/(lm*R4*z3pRpow3) + 6*l2m*z1111*(1 - lm/l2m)/(lm*R3*z3pRpow4) + 3*l2m*z1111*(1 - lm/l2m)/(lm*R5*z3pRpow2) - 12*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - 6*l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + 3*l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 15*z1111/R7 + 12*z11/R5 - 1/R3)/M_PI;
  const auto T_x_2  = lam*((1.0/4.0)*(l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) - 3*z13/R5)/(M_PI*mu) + (1.0/4.0)*(3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) + 2*l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*R*z3pRpow3) + l2m*z1*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*R*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 15*z1*z333/R7 - 9*z13/R5)/(M_PI*mu) + (1.0/4.0)*(-4*l2m*z111*z3*(1 - lm/l2m)/(lm*R4*z3pRpow3) - 3*l2m*z111*z3*(1 - lm/l2m)/(lm*R5*z3pRpow2) - 2*l2m*z111*(1 - lm/l2m)*(3*z3/R + 3)/(lm*R2*z3pRpow4) - l2m*z111*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R3*z3pRpow3) + 3*l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + 3*l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) + 15*z111*z3/R7 - 3*z13/R5)/(M_PI*mu)) + (1.0/2.0)*(-4*l2m*z111*z3*(1 - lm/l2m)/(lm*R4*z3pRpow3) - 3*l2m*z111*z3*(1 - lm/l2m)/(lm*R5*z3pRpow2) - 2*l2m*z111*(1 - lm/l2m)*(3*z3/R + 3)/(lm*R2*z3pRpow4) - l2m*z111*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R3*z3pRpow3) + 3*l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + 3*l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) + 15*z111*z3/R7 - 3*z13/R5)/M_PI;
  const auto T_x_4  = mu*((1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 + (1.0/R3))/(M_PI*mu));
  const auto T_x_6  = mu*((1.0/4.0)*(-3*l2m*z111*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 2*l2m*z111*(1 - lm/l2m)/(lm*R3*z3pRpow3) - 3*l2m*z111*(1 - lm/l2m)/(lm*R5*(z3pR)) + 3*l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) + 3*l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) - 15*z111*z3/R7 + 9*z13/R5)/(M_PI*mu) + (1.0/4.0)*(4*l2m*z111*z3*(1 - lm/l2m)/(lm*R4*z3pRpow3) + 3*l2m*z111*z3*(1 - lm/l2m)/(lm*R5*z3pRpow2) + 3*l2m*z111*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R2*z3pRpow4) + l2m*z111*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R3*z3pRpow3) - 3*l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) - 2*l2m*z1*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow3) - 2*l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) - 15*z111*z3/R7 + 3*z13/R5)/(M_PI*mu));
  const auto T_x_8  = mu*((1.0/4.0)*(2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) + 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) + l2m*z11*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R2*z3pRpow3) + l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) - l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) - l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 15*z11*z33/R7 - 3*z11/R5 - 3*z33/R5 + (1.0/R3))/(M_PI*mu) + (1.0/4.0)*(-3*l2m*z11*z33*(1 - lm/l2m)/(lm*R5*z3pRpow2) - 2*l2m*z11*z3*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R3*z3pRpow3) - l2m*z11*(1 - lm/l2m)*(2*z3/R + 2)*(3*z3/R + 3)/(lm*R*z3pRpow4) - l2m*z11*(1 - lm/l2m)*(2*z33/R3 - 2/R)/(lm*R*z3pRpow3) + l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*z3pRpow3) + l2m*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*z3pRpow2) + 15*z11*z33/R7 - 3*z11/R5 + 3*z33/R5 - 1/R3)/(M_PI*mu));
  const auto T_x_10 = T_x_4 ;
  const auto T_x_12 = lam*((1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(6*l2m*z1111*(1 - lm/l2m)/(lm*R4*z3pRpow3) + 6*l2m*z1111*(1 - lm/l2m)/(lm*R3*z3pRpow4) + 3*l2m*z1111*(1 - lm/l2m)/(lm*R5*z3pRpow2) - 12*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - 6*l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + 3*l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 15*z1111/R7 + 12*z11/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 15*z11*z33/R7 + 3*z11/R5 + 3*z33/R5 - 1/R3)/(M_PI*mu)) + (1.0/2.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/M_PI;
  const auto T_x_14 = lam*((1.0/4.0)*(l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) - 3*z13/R5)/(M_PI*mu) + (1.0/4.0)*(3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) + 2*l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*R*z3pRpow3) + l2m*z1*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*R*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 15*z1*z333/R7 - 9*z13/R5)/(M_PI*mu) + (1.0/4.0)*(-4*l2m*z111*z3*(1 - lm/l2m)/(lm*R4*z3pRpow3) - 3*l2m*z111*z3*(1 - lm/l2m)/(lm*R5*z3pRpow2) - 2*l2m*z111*(1 - lm/l2m)*(3*z3/R + 3)/(lm*R2*z3pRpow4) - l2m*z111*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R3*z3pRpow3) + 3*l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + 3*l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) + 15*z111*z3/R7 - 3*z13/R5)/(M_PI*mu)) + (1.0/2.0)*(l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) - 3*z13/R5)/M_PI;
  const auto T_x_16 = mu*((1.0/4.0)*(l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) + l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 3*z13/R5)/(M_PI*mu) + (1.0/4.0)*(-l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) - l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) + 3*z13/R5)/(M_PI*mu));
  const auto T_x_18 = T_x_6 ;
  const auto T_x_20 = T_x_8 ;
  const auto T_x_22 = T_x_16;
  const auto T_x_24 = lam*((1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(6*l2m*z1111*(1 - lm/l2m)/(lm*R4*z3pRpow3) + 6*l2m*z1111*(1 - lm/l2m)/(lm*R3*z3pRpow4) + 3*l2m*z1111*(1 - lm/l2m)/(lm*R5*z3pRpow2) - 12*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - 6*l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + 3*l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 15*z1111/R7 + 12*z11/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 15*z11*z33/R7 + 3*z11/R5 + 3*z33/R5 - 1/R3)/(M_PI*mu)) + (1.0/2.0)*(-2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 15*z11*z33/R7 + 3*z11/R5 + 3*z33/R5 - 1/R3)/M_PI;
  const auto T_x_26 = lam*((1.0/4.0)*(l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) - 3*z13/R5)/(M_PI*mu) + (1.0/4.0)*(3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) + 2*l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*R*z3pRpow3) + l2m*z1*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*R*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 15*z1*z333/R7 - 9*z13/R5)/(M_PI*mu) + (1.0/4.0)*(-4*l2m*z111*z3*(1 - lm/l2m)/(lm*R4*z3pRpow3) - 3*l2m*z111*z3*(1 - lm/l2m)/(lm*R5*z3pRpow2) - 2*l2m*z111*(1 - lm/l2m)*(3*z3/R + 3)/(lm*R2*z3pRpow4) - l2m*z111*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R3*z3pRpow3) + 3*l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + 3*l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) + 15*z111*z3/R7 - 3*z13/R5)/(M_PI*mu)) + (1.0/2.0)*(3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) + 2*l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*R*z3pRpow3) + l2m*z1*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*R*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 15*z1*z333/R7 - 9*z13/R5)/M_PI;
  const auto T_x_28 = lam*((1.0/4.0)*(3*l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 1/R3)/(M_PI*mu) + (1.0/4.0)*(l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 3*z33/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/(M_PI*mu)) + (1.0/2.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/M_PI;
  const auto T_x_30 = mu*((1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 3*z11/R5 + (1.0/R3))/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/(M_PI*mu));
  const auto T_x_32 = mu*((1.0/4.0)*(l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) - 3*z13/R5)/(M_PI*mu) + (1.0/4.0)*(l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) + 3*z13/R5)/(M_PI*mu));
  const auto T_x_34 = T_x_16;
  const auto T_x_36 = T_x_30;
  const auto T_x_38 = T_x_32;
  const auto T_x_40 = lam*((1.0/4.0)*(3*l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 1/R3)/(M_PI*mu) + (1.0/4.0)*(l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 3*z33/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/(M_PI*mu)) + (1.0/2.0)*(3*l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 1/R3)/M_PI;
  const auto T_x_42 = mu*((1.0/4.0)*(l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) + l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 3*z13/R5)/(M_PI*mu) + (1.0/4.0)*(-l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) - 2*l2m*z1*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow3) - 3*z13/R5)/(M_PI*mu));
  const auto T_x_44 = mu*((1.0/4.0)*(-l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) - l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 3*z33/R5 + (1.0/R3))/(M_PI*mu) + (1.0/4.0)*(l2m*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*z3pRpow3) + l2m*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*z3pRpow2) + 3*z33/R5 - 1/R3)/(M_PI*mu));
  const auto T_x_46 = T_x_16;
  const auto T_x_48 = T_x_42;
  const auto T_x_50 = T_x_44;
  const auto T_x_52 = lam*((1.0/4.0)*(3*l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 1/R3)/(M_PI*mu) + (1.0/4.0)*(l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 3*z33/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z11/R5 - 1/R3)/(M_PI*mu)) + (1.0/2.0)*(l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 3*z33/R5 - 1/R3)/M_PI;
  const auto T_x_54 = lam*((1.0/4.0)*(-l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 3*z13/R5)/(M_PI*mu) + (1.0/4.0)*(3*l2m*z111*(1 - lm/l2m)/(lm*R4*z3pRpow2) + 2*l2m*z111*(1 - lm/l2m)/(lm*R3*z3pRpow3) + 3*l2m*z111*(1 - lm/l2m)/(lm*R5*(z3pR)) - 3*l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - 3*l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) - 15*z111*z3/R7 + 9*z13/R5)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z1*z33*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R2*z3pRpow3) - l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) - l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - 2*l2m*z1*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow3) + l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) - 15*z1*z333/R7 - 3*z13/R5 - 3*z1*(2*x3 + 2*y3)/R5)/(M_PI*mu)) + (1.0/2.0)*(3*l2m*z111*(1 - lm/l2m)/(lm*R4*z3pRpow2) + 2*l2m*z111*(1 - lm/l2m)/(lm*R3*z3pRpow3) + 3*l2m*z111*(1 - lm/l2m)/(lm*R5*(z3pR)) - 3*l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - 3*l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) - 15*z111*z3/R7 + 9*z13/R5)/M_PI;
  const auto T_x_56 = lam*((1.0/4.0)*(l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 3*z33/R5 + (1.0/R3))/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) - l2m*z11*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 15*z11*z33/R7 - 3*z11/R5 - 3*z33/R5 + (1.0/R3))/(M_PI*mu) + (1.0/4.0)*(3*l2m*z333*(1 - lm/l2m)/(lm*R5*(z3pR)) + 2*l2m*z33*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*R*z3pRpow3) + l2m*z3*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*R*z3pRpow2) - l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(2*x3 + 2*y3)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*z3pRpow3) + l2m*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*z3pRpow2) - 2*l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 15*z3333/R7 + 6*z3*(2*x3 + 2*y3)/R5 + (1.0/R3))/(M_PI*mu)) + (1.0/2.0)*(-2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) - l2m*z11*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 15*z11*z33/R7 - 3*z11/R5 - 3*z33/R5 + (1.0/R3))/M_PI;
  const auto T_x_58 = (1.0/2.0)*(-l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 3*z13/R5)/M_PI;
  const auto T_x_60 = mu*((1.0/4.0)*(2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) + 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) + 2*l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R2*z3pRpow3) + l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) - l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) - l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 15*z11*z33/R7 + 3*z11/R5 + 3*z33/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(-3*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 2*l2m*z11*z3*(1 - lm/l2m)/(lm*R3*z3pRpow3) - 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z11*(1 - lm/l2m)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R2*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) - 15*z11*z33/R7 - 3*z11/R5 + 3*z33/R5 + (1.0/R3))/(M_PI*mu));
  const auto T_x_62 = mu*((1.0/4.0)*(-3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) - l2m*z1*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*R*z3pRpow3) - l2m*z1*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*R*z3pRpow2) + l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 15*z1*z333/R7 - 9*z13/R5)/(M_PI*mu) + (1.0/4.0)*(2*l2m*z1*z33*(1 - lm/l2m)/(lm*R4*z3pRpow2) + 3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) + l2m*z13*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R2*z3pRpow3) + l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) + l2m*z1*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R*z3pRpow3) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 15*z1*z333/R7 + 3*z13/R5 + 3*z1*(2*x3 + 2*y3)/R5)/(M_PI*mu));
  const auto T_x_64 = T_x_58;
  const auto T_x_66 = lam*((1.0/4.0)*(-l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 3*z13/R5)/(M_PI*mu) + (1.0/4.0)*(3*l2m*z111*(1 - lm/l2m)/(lm*R4*z3pRpow2) + 2*l2m*z111*(1 - lm/l2m)/(lm*R3*z3pRpow3) + 3*l2m*z111*(1 - lm/l2m)/(lm*R5*(z3pR)) - 3*l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - 3*l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) - 15*z111*z3/R7 + 9*z13/R5)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z1*z33*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R2*z3pRpow3) - l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) - l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - 2*l2m*z1*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow3) + l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) - 15*z1*z333/R7 - 3*z13/R5 - 3*z1*(2*x3 + 2*y3)/R5)/(M_PI*mu)) + (1.0/2.0)*(-l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 3*z13/R5)/M_PI;
  const auto T_x_68 = lam*((1.0/4.0)*(l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 3*z33/R5 + (1.0/R3))/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) - l2m*z11*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 15*z11*z33/R7 - 3*z11/R5 - 3*z33/R5 + (1.0/R3))/(M_PI*mu) + (1.0/4.0)*(3*l2m*z333*(1 - lm/l2m)/(lm*R5*(z3pR)) + 2*l2m*z33*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*R*z3pRpow3) + l2m*z3*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*R*z3pRpow2) - l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(2*x3 + 2*y3)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*z3pRpow3) + l2m*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*z3pRpow2) - 2*l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 15*z3333/R7 + 6*z3*(2*x3 + 2*y3)/R5 + (1.0/R3))/(M_PI*mu)) + (1.0/2.0)*(l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 3*z33/R5 + (1.0/R3))/M_PI;
  const auto T_x_70 = mu*((1.0/4.0)*(-l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) - l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 3*z33/R5 - 1/R3)/(M_PI*mu) + (1.0/4.0)*(l2m*z3*(1 - lm/l2m)/(lm*R2*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)/(lm*R*z3pRpow2) + 3*z33/R5 + (1.0/R3))/(M_PI*mu));
  const auto T_x_72 = T_x_60;
  const auto T_x_74 = T_x_62;
  const auto T_x_76 = T_x_70;
  const auto T_x_78 = lam*((1.0/4.0)*(-l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) + 3*z13/R5)/(M_PI*mu) + (1.0/4.0)*(3*l2m*z111*(1 - lm/l2m)/(lm*R4*z3pRpow2) + 2*l2m*z111*(1 - lm/l2m)/(lm*R3*z3pRpow3) + 3*l2m*z111*(1 - lm/l2m)/(lm*R5*(z3pR)) - 3*l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - 3*l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) - 15*z111*z3/R7 + 9*z13/R5)/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z1*z33*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R2*z3pRpow3) - l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) - l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - 2*l2m*z1*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow3) + l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) - 15*z1*z333/R7 - 3*z13/R5 - 3*z1*(2*x3 + 2*y3)/R5)/(M_PI*mu)) + (1.0/2.0)*(-2*l2m*z1*z33*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z1*z33*(1 - lm/l2m)/(lm*R5*(z3pR)) - 2*l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R2*z3pRpow3) - l2m*z13*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) - l2m*z13*(1 - lm/l2m)/(lm*R3*z3pRpow2) + l2m*z1*(1 - lm/l2m)/(lm*R2*z3pRpow2) - 2*l2m*z1*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow3) + l2m*z1*(1 - lm/l2m)/(lm*R3*(z3pR)) - 15*z1*z333/R7 - 3*z13/R5 - 3*z1*(2*x3 + 2*y3)/R5)/M_PI;
  const auto T_x_80 = lam*((1.0/4.0)*(l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) - 3*z33/R5 + (1.0/R3))/(M_PI*mu) + (1.0/4.0)*(-2*l2m*z11*z3*(1 - lm/l2m)/(lm*R4*z3pRpow2) - 3*l2m*z11*z3*(1 - lm/l2m)/(lm*R5*(z3pR)) - l2m*z11*(1 - lm/l2m)*(2*z3/R + 2)/(lm*R2*z3pRpow3) - l2m*z11*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 15*z11*z33/R7 - 3*z11/R5 - 3*z33/R5 + (1.0/R3))/(M_PI*mu) + (1.0/4.0)*(3*l2m*z333*(1 - lm/l2m)/(lm*R5*(z3pR)) + 2*l2m*z33*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*R*z3pRpow3) + l2m*z3*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*R*z3pRpow2) - l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(2*x3 + 2*y3)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*z3pRpow3) + l2m*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*z3pRpow2) - 2*l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 15*z3333/R7 + 6*z3*(2*x3 + 2*y3)/R5 + (1.0/R3))/(M_PI*mu)) + (1.0/2.0)*(3*l2m*z333*(1 - lm/l2m)/(lm*R5*(z3pR)) + 2*l2m*z33*(1 - lm/l2m)*(z3/R + 1)/(lm*R3*z3pRpow2) + l2m*z3*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*R*z3pRpow3) + l2m*z3*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*R*z3pRpow2) - l2m*z3*(1 - lm/l2m)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(2*x3 + 2*y3)/(lm*R3*(z3pR)) + l2m*(1 - lm/l2m)*(z3/R + 1)*(2*z3/R + 2)/(lm*z3pRpow3) + l2m*(1 - lm/l2m)*(z33/R3 - 1/R)/(lm*z3pRpow2) - 2*l2m*(1 - lm/l2m)*(z3/R + 1)/(lm*R*z3pRpow2) + 15*z3333/R7 + 6*z3*(2*x3 + 2*y3)/R5 + (1.0/R3))/M_PI;
  RealT u_x[9];
  u_x[0] = T_x_0 *d1*v1 + T_x_6 *d1*v3 + T_x_12*d2*v2 + T_x_18*d3*v1 + T_x_24*d3*v3;
  u_x[1] = T_x_4 *d1*v2 + T_x_10*d2*v1 + T_x_16*d2*v3 + T_x_22*d3*v2;
  u_x[2] = T_x_2 *d1*v1 + T_x_8 *d1*v3 + T_x_14*d2*v2 + T_x_20*d3*v1 + T_x_26*d3*v3;
  u_x[3] = T_x_30*d1*v2 + T_x_36*d2*v1 + T_x_42*d2*v3 + T_x_48*d3*v2;
  u_x[4] = T_x_28*d1*v1 + T_x_34*d1*v3 + T_x_40*d2*v2 + T_x_46*d3*v1 + T_x_52*d3*v3;
  u_x[5] = T_x_32*d1*v2 + T_x_38*d2*v1 + T_x_44*d2*v3 + T_x_50*d3*v2;
  u_x[6] = T_x_54*d1*v1 + T_x_60*d1*v3 + T_x_66*d2*v2 + T_x_72*d3*v1 + T_x_78*d3*v3;
  u_x[7] = T_x_58*d1*v2 + T_x_64*d2*v1 + T_x_70*d2*v3 + T_x_76*d3*v2;
  u_x[8] = T_x_56*d1*v1 + T_x_62*d1*v3 + T_x_68*d2*v2 + T_x_74*d3*v1 + T_x_80*d3*v3;
  const RealT udiv = u_x[0] + u_x[4] + u_x[8];
  sigma[0] = lam*udiv + mu*(u_x[0] + u_x[0]);
  sigma[1] = mu*(u_x[1] + u_x[3]);
  sigma[2] = mu*(u_x[2] + u_x[6]);
  sigma[3] = lam*udiv + mu*(u_x[4] + u_x[4]);
  sigma[4] = mu*(u_x[5] + u_x[7]);
  sigma[5] = lam*udiv + mu*(u_x[8] + u_x[8]);
}

template void calc_halfspace_term_B<Real> (
  const Real lam, const Real mu, const Real v[3], const Real d[3],
  const Real& y3, const Real& x1, const Real& x3, Real sigma[6]);

#ifdef WOODLAND_ACORN_VECTORIZE
# message "ERROR: WOODLAND_ACORN_VECTORIZE is not supported yet."
error
#endif

} // namespace hs3d
} // namespace acorn
} // namespace woodland
